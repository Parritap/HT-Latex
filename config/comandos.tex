
% Configuración del tamaño de secciones y subsecciones
\titleformat{\section}
{\large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
{\normalsize\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
{\normalsize\bfseries}{\thesubsubsection}{1em}{}

% ##### Forar más espacio entre parrafos ########

\setlength{\parskip}{1em}  % Space between paragraphs
\setlength{\parindent}{0pt}  % Remove paragraph indentation (optional)

%############################


\input{config/variables.tex}

% Configuración de encabezados y pies de página
\pagestyle{fancy}
\fancyhf{} % Limpia todos los encabezados y pies
\renewcommand{\headrulewidth}{0pt} % Sin línea en el encabezado
\renewcommand{\footrulewidth}{0pt} % Sin línea en el pie

% Configuración del banner inferior desde la página 1
% Ajustes de posición en puntos (1pt ≈ 1 pixel a 72 DPI)
\newcommand{\bannerHeight}{68.16pt} % 2.4cm = 68.16pt
\newcommand{\bannerXOffset}{0pt} % Desplazamiento horizontal del banner
\newcommand{\bannerYOffset}{0pt} % Desplazamiento vertical del banner
\newcommand{\pageNumXOffset}{28.35pt} % 1cm = 28.35pt - posición X del número
\newcommand{\pageNumYOffset}{35.05pt} % 3cm = 85.05pt - posición Y del número

\fancyfoot[C]{%
	\begin{tikzpicture}[remember picture, overlay]
		% Banner que ocupa todo el ancho de la página
		\node[anchor=south, inner sep=0pt] at ([xshift=\bannerXOffset, yshift=\bannerYOffset]current page.south) {%
			\includegraphics[width=\paperwidth, height=\bannerHeight]{./images/banner-inferior.png}%
		};
		% Número de página sobre la imagen en la esquina inferior izquierda
		\node[anchor=south west, text=black, font=\bfseries]
		at ([xshift=\pageNumXOffset, yshift=\pageNumYOffset]current page.south west) {\thepage};
	\end{tikzpicture}%
}


% ################## Babel mod for tables  ##################
\addto\captionsspanish{\renewcommand{\tablename}{Tabla}}





% ################## SIGLAS ##################

% Marcador para la sección de Siglas
\newcommand{\siglaref}{\hyperref[cap:siglas]{\nameref{cap:siglas}}}

% Ahora definimos cada sigla con enlace hacia la lista
\newcommand{\HTC}{\hyperref[cap:siglas]{HTC}\xspace}
\newcommand{\CMMI}{\hyperref[cap:siglas]{CMMI}\xspace}
\newcommand{\CPU}{\hyperref[cap:siglas]{CPU}\xspace}
\newcommand{\DAR}{\hyperref[cap:siglas]{DAR}\xspace}
\newcommand{\GRID}{\hyperref[cap:siglas]{GRID}\xspace}
\newcommand{\IT}{\hyperref[cap:siglas]{IT}\xspace}
\newcommand{\SMS}{\hyperref[cap:siglas]{SMS}\xspace}
\newcommand{\VBC}{\hyperref[cap:siglas]{VBC}\xspace}
\newcommand{\TI}{\hyperref[cap:siglas]{TI}\xspace}
\newcommand{\PMV}{\hyperref[cap:siglas]{PMV}\xspace}
\newcommand{\PMBOK}{\hyperref[cap:siglas]{PMBOK}\xspace}
\newcommand{\ISO}{\hyperref[cap:siglas]{ISO}\xspace}
\newcommand{\CNCF}{\hyperref[cap:siglas]{CNCF}\xspace}
\newcommand{\TOGAF}{\hyperref[cap:siglas]{TOGAF}\xspace}
\newcommand{\IEC}{\hyperref[cap:siglas]{IEC}\xspace}
\newcommand{\CS}{\hyperref[cap:siglas]{CS}\xspace}
\newcommand{\CLI}{\hyperref[cap:siglas]{CLI}\xspace}
\newcommand{\UI}{\hyperref[cap:siglas]{UI}\xspace}
\newcommand{\HPC}{\hyperref[cap:siglas]{HPC}\xspace}
\newcommand{\AWS}{\hyperref[cap:siglas]{AWS}\xspace}
\newcommand{\OCI}{\hyperref[cap:siglas]{OCI}\xspace}
\newcommand{\VM}{\hyperref[cap:siglas]{VM}\xspace}
\newcommand{\OS}{\hyperref[cap:siglas]{OS}\xspace}
\newcommand{\PMI}{\hyperref[cap:siglas]{PMI}\xspace}
\newcommand{\CPD}{\hyperref[cap:siglas]{CPD}\xspace}
\newcommand{\NPO}{\hyperref[cap:siglas]{NPO}\xspace}
\newcommand{\MPI}{\hyperref[cap:siglas]{MPI}\xspace}
\newcommand{\SCI}{\hyperref[cap:siglas]{SCI}\xspace}
\newcommand{\CVI}{\hyperref[cap:siglas]{CVI}\xspace}
\newcommand{\IRRQ}{\hyperref[cap:siglas]{IRRQ}\xspace}
\newcommand{\DOFA}{\hyperref[cap:siglas]{DOFA}\xspace}
\newcommand{\TDD}{\hyperref[cap:siglas]{TDD}\xspace}
\newcommand{\IPC}{\hyperref[cap:siglas]{IPC}\xspace}
\newcommand{\JSON}{\hyperref[cap:siglas]{JSON}\xspace}
\newcommand{\API}{\hyperref[cap:siglas]{API}\xspace}
\newcommand{\UML}{\hyperref[cap:siglas]{UML}\xspace}

\newcommand{\HTCondor}{\hbox{HTCondor}} %Para que LaTex no corte la palabra en los saltos de linea


% ####################################################


% ################## COMANDOS ESTILISTICOS ##################
\newcommand{\ie}{\textit{i.e.}\xspace}
% ####################################################

% Comando para capítulos SIN numeración de página (páginas especiales)
\newcommand{\ChapterImageEmpty}[3][]{%
	\cleardoublepage
	\thispagestyle{fancy}%
	\refstepcounter{chapter}%
	\AddToShipoutPictureBG*{%
		\begin{tikzpicture}[remember picture,overlay]
			% Imagen de fondo al ancho de la página
			\node[inner sep=0pt, anchor=north west] at (current page.north west)
			{\includegraphics[width=\paperwidth]{#3}};
			% Caja blanca que se adapta al ancho del texto
			\node[
				anchor=north west,
				xshift=1.5cm, yshift=-1.0cm,
				text=black,
				fill=white, fill opacity=0.8,
				rounded corners=6pt,
				inner xsep=10pt, inner ysep=6pt
			] at (current page.north west)
			{\Large\bfseries \thechapter\quad #2\strut};
		\end{tikzpicture}
	}%
}

% Comando para secciones preliminares (sin numeración pero en índice)
\newcommand{\ChapterImagePrelim}[3][]{%
	\cleardoublepage%
	\phantomsection%
	\addcontentsline{toc}{chapter}{#2}%
	\AddToShipoutPictureBG*{%
		\begin{tikzpicture}[remember picture,overlay]
			% Imagen de fondo al ancho de la página
			\node[inner sep=0pt, anchor=north west] at (current page.north west)
			{\includegraphics[width=\paperwidth]{#3}};
			% Caja blanca que se adapta al ancho del texto
			\node[
				anchor=north west,
				xshift=1.5cm, yshift=-1.0cm,
				text=black,
				fill=white, fill opacity=0.8,
				rounded corners=6pt,
				inner xsep=10pt, inner ysep=6pt
			] at (current page.north west)
			{\Large\bfseries #2\strut};
		\end{tikzpicture}
	}%
}

% Comando para capítulos CON numeración de página (capítulos normales)
\newcommand{\ChapterImageStar}[3][]{%
	\cleardoublepage%
	\refstepcounter{chapter}%
	\addcontentsline{toc}{chapter}{\protect\numberline{\thechapter}#2}%
	\AddToShipoutPictureBG*{%
		\begin{tikzpicture}[remember picture,overlay]
			% Imagen de fondo al ancho de la página
			\node[inner sep=0pt, anchor=north west] at (current page.north west)
			{\includegraphics[width=\paperwidth]{#3}};
			% Caja blanca que se adapta al ancho del texto
			\node[
				anchor=north west,
				xshift=1.5cm, yshift=-1.0cm,
				text=black,
				fill=white, fill opacity=0.8,
				rounded corners=6pt,
				inner xsep=10pt, inner ysep=6pt
			] at (current page.north west)
			{\Large\bfseries \thechapter\quad #2\strut};
		\end{tikzpicture}
	}%
}

\newcommand\BackgroundPic{%
	\put(-25,-2){%
		\parbox[b][\paperheight]{\paperwidth}{%
			\vfill
			\centering
			\includegraphics[scale=1,height=\paperheight]{./images/fondo-anteportada.png}%
			\vfill
		}}}

\newcommand\PortadaPic{%
	\put(0,0){%
		\parbox[b][\paperheight]{\paperwidth}{%
			\vfill
			\centering
			\includegraphics[width=\paperwidth,height=\paperheight]{images/portada.png}%
			\vfill
		}}}



% Definir colores estilo "Carbon"
\definecolor{bg}{HTML}{FEFEFE}      % Fondo oscuro
\definecolor{fg}{HTML}{3b3c3d}      % Texto principal
\definecolor{keyword}{HTML}{C678DD} % Palabras clave (if, then, else...)
\definecolor{string}{HTML}{98C379}  % Strings
\definecolor{comment}{HTML}{C62828} % Comentarios
\definecolor{number}{HTML}{000000}  % Números
\definecolor{builtin}{HTML}{61AFEF} % Comandos (echo, ssh...)


\setminted{fontsize=\scriptsize}
% Configuración global de minted
\setminted{
	bgcolor=bg,
	fontfamily=tt,
	linenos,
	numbersep=5pt,
	gobble=0,
	breaklines,
	breakanywhere,
	frame=none,
	baselinestretch=1.2,
}
% Personalizar colores
\renewcommand{\theFancyVerbLine}{\textcolor{number}{\arabic{FancyVerbLine}}}



% Comando para partes del documento (diseño centrado con posición personalizable)
% Uso: \PartImage[xpos,ypos]{Título}{imagen.png}
% xpos: desplazamiento horizontal en puntos desde el centro (positivo = derecha, negativo = izquierda)
% ypos: desplazamiento vertical en puntos desde el centro (positivo = arriba, negativo = abajo)
\newcommand{\PartImage}[4][0pt,0pt]{%
	\cleardoublepage%
	\thispagestyle{empty}%
	\refstepcounter{part}%
	\addcontentsline{toc}{part}{\protect\numberline{\thepart}#2}%
	% Procesar las coordenadas del parámetro opcional
	\def\tempcoords{#1}%
	\expandafter\parsecoords\tempcoords\relax%
	\AddToShipoutPictureBG*{%
		\begin{tikzpicture}[remember picture,overlay]
			% Imagen de fondo que ocupa toda la página
			\node[inner sep=0pt] at (current page.center)
			{\includegraphics[width=\paperwidth,height=\paperheight]{#3}};
			% Título en posición personalizable con salto de línea
			\node[
				text=black,
				fill=white, fill opacity=0.9,
				rounded corners=10pt,
				inner xsep=20pt, inner ysep=15pt,
				font=\Huge\bfseries,
				align=center
			] at ([xshift=\xpos,yshift=\ypos]current page.center)
			{PARTE \thepart\\#2};
		\end{tikzpicture}
	}%
	\vspace*{3cm}%
	\phantom{.}%
	\newpage%
}

% Comando auxiliar para procesar coordenadas
\def\parsecoords#1,#2\relax{%
	\def\xpos{#1}%
	\def\ypos{#2}%
}

% Configuración de headers para anexos (definida aquí, aplicada en anexos.tex)
\fancypagestyle{anexos}{
	\fancyhf{}
	\fancyhead[L]{\leftmark}
	% Sin número de página en header (ya está en el banner inferior)
	\renewcommand{\headrulewidth}{0.4pt}
	\renewcommand{\footrulewidth}{0pt}
	% Agregar el mismo banner inferior que las otras páginas
	\fancyfoot[C]{%
		\begin{tikzpicture}[remember picture, overlay]
			% Banner que ocupa todo el ancho de la página
			\node[anchor=south, inner sep=0pt] at ([xshift=\bannerXOffset, yshift=\bannerYOffset]current page.south) {%
				\includegraphics[width=\paperwidth, height=\bannerHeight]{./images/banner-inferior.png}%
			};
			% Número de página sobre la imagen en la esquina inferior izquierda
			\node[anchor=south west, text=black, font=\bfseries]
			at ([xshift=\pageNumXOffset, yshift=\pageNumYOffset]current page.south west) {\thepage};
		\end{tikzpicture}%
	}
}
